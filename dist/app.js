!function(e){function t(t){for(var a,o,l=t[0],i=t[1],c=t[2],u=0,p=[];u<l.length;u++)o=l[u],s[o]&&p.push(s[o][0]),s[o]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);for(d&&d(t);p.length;)p.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,l=1;l<n.length;l++){var i=n[l];0!==s[i]&&(a=!1)}a&&(r.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},s={0:0},r=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/dist";var l=window.webpackJsonp=window.webpackJsonp||[],i=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var d=i;r.push([9,1]),n()}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(8);t.createElement=((e,t,n)=>({element:e,props:n?Object.assign({},t,{children:n.filter?n.filter(e=>e):n}):t})),t.componentMixin=(()=>({props:null,host:null,_innerTree:null,send(e){const n=this.reducer(e,this.state);t.updateComponentBySelf(this,n)}})),t.render=((e,n,a)=>{const s=e.element;if("string"==typeof s){const r=/div|span/.test(s)?document.createElement(s):document.createElementNS("http://www.w3.org/2000/svg",s),o=e.props.children;e.host=r;for(let t in e.props)"children"!==t&&r.setAttributeNS(null,t,e.props[t]);o&&("string"==typeof o?r.textContent=o:e.props.children=e.props.children.map(e=>t.render(e,r))),n&&a?function(e,t){var n=t.parentNode,a=t.nextSibling;a?n.insertBefore(e,a):n.appendChild(e)}(r,a):n.append(r)}else{const r=s();r.props=e.props;const o=t.renderComponent(r,e.props);r._innerTree=o,e.host=n,e._instance=r,t.render(o,n,a),r.didMount&&r.didMount()}return e}),t.renderComponent=((e,t,n)=>{let a=n||e.state;return!n&&e.getDeriviedStateFromProps&&(a=e.getDeriviedStateFromProps(t,e.state)),e.state=a,e.render(t,a)}),t.updateChildren=((e,n)=>{const{props:s,host:r}=e,{props:o}=n;if(e.element!==n.element)return t.render(n,r.parentElement),void r.parentElement.removeChild(r);if("function"==typeof n.element)return t.updateComponentByParent(e._instance,n.props),n.host=r,void(n._instance=e._instance);if(n.host=r,s!==o)for(let e in o)"children"!==e&&(null!=s[e]&&s[e]===o[e]||r.setAttribute(e,o[e]));if(o.children||!s.children){if(o.children){if("string"==typeof o.children)return void(r.textContent=o.children);if(!s.children||!s.children.length){for(let e of o.children)t.render(e,r);return}if(null!=s.children[0].props.key){const e=a.getChildMapping(s.children);let n,l=a.getChildMapping(o.children),i=a.mergeChildMappings(e,l);return void Object.keys(i).sort().forEach(a=>{let s=i[a];const o=a in e,c=a in l,d=e[a];if(c&&!o){const e=l[n]&&l[n]._instance&&l[n]._instance._innerTree.host;t.render(s,r,e),n=a}else!c&&o?r.removeChild(d.host):c&&o&&(t.updateChildren(d,s),n=a)})}let e=Math.max(o.children.length,s.children.length),n=0;for(;n<e;){const e=s.children[n],a=o.children[n];e?a?t.updateChildren(e,a):r.removeChild(e.host):t.render(a,r),n++}}}else{if("string"==typeof s.children)return void(r.innerHTML="");for(let e of s.children)r.removeChild(e.host)}}),t.updateComponentBySelf=((e,n)=>{const a=e.state,s=e.props,r=t.renderComponent(e,s,n);t.updateChildren(e._innerTree,r),e._innerTree=r,e.didUpdate&&e.didUpdate(s,a)}),t.updateComponentByParent=((e,n)=>{const a=e.state,s=e.props;if(e.shouldUpdate&&!e.shouldUpdate(n))return;e.props=n;const r=t.renderComponent(e,n);t.updateChildren(e._innerTree,r),e._innerTree=r,e.didUpdate&&e.didUpdate(s,a)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(0),s=n(10);t.createRaf=(e=>{let t=!0;return(...n)=>{t&&(t=!1,requestAnimationFrame(()=>{e(...n),t=!0}))}}),t.values=Object.values||(e=>Object.keys(e).map(t=>e[t])),t.zipDots=(e=>{const t=e[0].length;let n=-1,a=Array(t);for(;++n<t;)a[n]=e.map(e=>e[n]);return a}),t.shallowEqual=((e,t)=>{if(e.length!==t.length)return!1;let n=0;for(;n<e.length;){if(e[n]!==t[n])return!1;n++}return!0}),t.getStackedMax=((e,t,n)=>{let a=-1/0;for(let s=e;s<t;s++){let e=0;for(let t=0;t<n.length;t++)e+=n[t].values[s],a=Math.max(e,a)}return a});var r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];t.prettifyDate=((e,t)=>{const n=new Date(e),a=o[n.getDay()],s=n.getDate(),l=r[n.getMonth()],i=n.getFullYear();switch(t){case"d m y":return`${s} ${l} ${i}`;case"dr m y":return`${l} ${i}`;case"dt, d m y":return`${a}, ${s} ${l} ${i}`;case"m d":return`${l} ${s}`;case"h:m":const e=n.getUTCHours(),r=n.getUTCMinutes();return`${e>9?"":"0"}${e}:${r>9?"":"0"}${r}`}}),t.repeat=((e,t)=>{const n=[];for(let a=0;a<e;a++)n.push(t);return n}),t.path=((e,t,n,r,o,l)=>a.createElement("path",{d:e,"stroke-width":n.toFixed(1),stroke:t,class:`transition ${r}`,"vector-effect":o?"":"non-scaling-stroke","stroke-linejoin":o?"":"round",fill:l?t:"none",key:t,calcMode:"paced"},[a.createElement(s.Animate,{value:e})])),t.createPathAttr=((e,t,n)=>e.reduce((e,[a,s],r)=>0===r?`M0 ${n(s)}`:e+` L${t(a)} ${n(s)}`,"")),t.createStackedPathAttr=((e,t,n,a)=>e.reduce((e,[s,r],o)=>e+`M${t(s)} ${n(a[o])}L${t(s)} ${n(r+a[o])}`,"")),t.createPercentagePathAttr=((e,t,n,a)=>e.reduce((e,[s,r],o)=>e+`L${t(s)} ${n(r+a[o])}`,`M0 ${n(0)}`)+`L${t(e[e.length-1][0])} ${n(0)}Z`),t.max_=(e=>Math.max.apply(Math,e)),t.min_=(e=>Math.min.apply(Math,e)),t.last=(e=>e[e.length-1]),t.rest=(e=>{const[t,...n]=e;return n}),t.catValuesByDates=((e,n,a,s,r,o)=>{const l=o||t.max_(n),i=r||t.min_(n),c=l-i;return n.filter((t,n)=>e[n+1]>=i+c*a&&e[n+1]<=i+c*s)}),t.catValues=((e,n,a,s,r)=>{const o=r||t.max_(e),l=s||t.min_(e),i=o-l;return e.filter(e=>e>=l+i*n&&e<=l+i*a)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CHART_HEIGHT=315,t.CHART_WIDTH=(document.documentElement.offsetWidth||120)-20,t.SLIDER_HEIGHT=45,t.PRECISION=4},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=function(e,t,n){return t/n.range*e};t.round=function(e,t){var n=Math.pow(10,t||8);return Math.round(e*n)/n};t.getBounds=function(e,n,s,r=50,o=!1){var l,i,c,d=0,u={high:n,low:s};u.valueRange=u.high-u.low,u.oom=function(e){return Math.floor(Math.log(Math.abs(e))/Math.LN10)}(u.valueRange),u.step=Math.pow(10,u.oom),u.min=Math.floor(u.low/u.step)*u.step,u.max=Math.ceil(u.high/u.step)*u.step,u.range=u.max-u.min,u.numberOfSteps=Math.round(u.range/u.step);var p=a(e,u.step,u)<r,h=o?function(e){if(1===e)return e;function t(e,n){return e%n==0?n:t(n,e%n)}function n(e){return e*e+1}var a,s=2,r=2;if(e%2==0)return 2;do{s=n(s)%e,r=n(n(r))%e,a=t(Math.abs(s-r),e)}while(1===a);return a}(u.range):0;if(o&&a(e,1,u)>=r)u.step=1;else if(o&&h<u.step&&a(e,h,u)>=r)u.step=h;else for(;;){if(p&&a(e,u.step,u)<=r)u.step*=2;else{if(p||!(a(e,u.step/2,u)>=r))break;if(u.step/=2,o&&u.step%1!=0){u.step*=2;break}}if(d++>1e3)throw new Error("Exceeded maximum number of iterations while optimizing scale step!")}var m=2.221e-16;function f(e,t){return e===(e+=t)&&(e*=1+(t>0?m:-m)),e}for(u.step=Math.max(u.step,m),i=u.min,c=u.max;i+u.step<=u.low;)i=f(i,u.step);for(;c-u.step>=u.high;)c=f(c,-u.step);u.min=i,u.max=c,u.range=u.max-u.min;var g=[];for(l=u.min;l<=u.max;l=f(l,u.step)){var v=t.round(l);v!==g[g.length-1]&&g.push(v)}return u.values=g,u},t.getBoundsX=((e,t,n)=>{let a=(t-n+36e5)/7;e>1.6&&(a/=2),e>3.2&&(a/=2),e>6.4&&(a/=2);const s=[n];let r=n;for(;r<t;)r+=a,s.push(r);return s})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(0),s=n(8),r=n(1);t.TransitionGroup=(()=>Object.assign({},a.componentMixin(),{state:{isFirstRender:!0},getDeriviedStateFromProps:(e,t)=>({children:t.isFirstRender?s.getInitialChildMapping(e.children):s.getNextChildMapping(e.children,t.children,e.passedProps),isFirstRender:!1}),render:(e,t)=>e.wrapper(r.values(t.children))}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(0);t.Transition=(()=>Object.assign({},a.componentMixin(),{state:{status:"entered",in:null},timer:null,getDeriviedStateFromProps(e,t){const n=t.status;return null===t.in?Object.assign({},t,{in:e.in,status:"enter"===e.status?"entered":"entering"}):e.in||!t.in||"entered"!==n&&"entering"!==n?!e.in||t.in||"exited"!==n&&"exiting"!==n?t:{in:e.in,status:"entering"}:{in:e.in,status:"exiting"}},didUpdate(){const e=this.state;"exiting"===e.status&&(clearTimeout(this.timer),this.timer=setTimeout(()=>{this.send({type:"update"})},this.props.timeout||200)),"entering"===e.status&&(clearTimeout(this.timer),this.timer=setTimeout(()=>{this._innerTree.host.scrollTop,this.send({type:"entered"})},10))},didMount(){"entering"===this.state.status&&setTimeout(()=>{this.send({type:"entered"})},20)},render:(e,t)=>e.children(t.status,e.passedProps),reducer:(e,t)=>{switch(e.type){case"entered":return Object.assign({},t,{status:"entered"});case"update":return Object.assign({},t,{status:"exited"});case"show":return Object.assign({},t,{status:"entering"})}}}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(2),s=n(3),r=n(1);t.getScaleY=((e,t,n)=>e/(t-n)),t.getScaleX=((e,t)=>e/t);const o={};t.prepareData=((e,n)=>{const l=e.columns,i=l[0],c=i.length-1,d=i[1],u=t.getScaleX(a.CHART_WIDTH,r.last(i)-d),p=[],h=e=>Math[e].apply(Math,l.slice(1).map(t=>Math[e].apply(Math,t.slice(1)))),m=(e,t,n)=>e(l.slice(t,n).map(t=>e(t.slice(1)))),f=m(e=>Math.max.apply(Math,e),0,1),g=m(e=>Math.min.apply(Math,e),0,1);let v=e.percentage?100:h("max");const T=null!=n&&o[n]||v/1e3>1?v/1e6>1?1e6:1e3:1;o[n]=T,v=s.round(v/T,a.PRECISION);const y=e.stacked?0:s.round(h("min")/T,a.PRECISION);let E=t.getScaleY(a.SLIDER_HEIGHT,v,y);const H=e=>s.round((e-d)*u,1),b=e=>t=>s.round(a.CHART_HEIGHT-e(t),a.PRECISION);let _=1;l.sort((e,t)=>e[1]>t[1]?-1:e[1]===t[1]?0:1);const S=[];for(let e=0;e<c;e++){let t=0;for(let n=1;n<l.length;n++)t+=l[n][e+1];S.push(t)}for(;_<l.length;){const n=l[_][0];let o=r.rest(l[_]);const c=o;o=e.percentage?o.map((e,t)=>s.round(e/S[t]*100,0)):o.map(e=>s.round(e/T,a.PRECISION));const d=Math.max.apply(Math,o),u=Math.min.apply(Math,o);e.y_scaled&&(E=t.getScaleY(a.SLIDER_HEIGHT,d,u));const h=o.map((e,t)=>[i[t+1],e]),m={name:e.names[n],color:e.colors[n],chartPath:e.stacked?null:r.createPathAttr(h,H,b(e=>e)),sliderPath:e.stacked?null:r.createPathAttr(h,H,t=>s.round(a.SLIDER_HEIGHT-(t-(e.y_scaled?u:y))*E,1)),max:d,min:u,id:n,values:o,originalValues:c,dots:h};p.push(m),_++}const x={};for(let t in e.names)x[t]=!0;return{charts:p,visibles:x,maxY:v,minY:y,maxX:f,minX:g,scaleX:u,data:e,dataLength:c,pow:T,scaledX_:H,y__:b}}),t.localPrepare=((e,n)=>{const{maxX:o,minX:l,data:i,dataLength:c}=e,{visibles:d,sliderPos:{left:u,right:p},extraScale:h}=n,m=e.charts.filter(e=>d[e.id]),f=s.getBoundsX(h,o,l);if(0===m.length)return{offsetY:0,offsetY2:null,scaleY:1,scaleY2:null,valuesY2:null,valuesY:[0,0,0,0,0,0],charts:m,valuesX:f};const g=m.map(e=>Object.assign({},e,{values:r.catValuesByDates(i.columns[0],e.values,u,p,l,o)})),v=(e,t)=>e(t.map(({values:t})=>e(t))),T=i.y_scaled,y=i.stacked;let E,H,b,_;if(T){const e=g.filter(e=>"y0"===e.id);E=v(r.min_,e),H=v(r.max_,e);const t=g.filter(e=>"y1"===e.id);b=v(r.min_,t),_=v(r.max_,t)}else y?(E=0,H=i.percentage?100:r.getStackedMax(0,g.length?g[0].values.length:0,g)):(E=v(r.min_,g),H=v(r.max_,g));let{values:S,max:x,min:O}=s.getBounds(a.CHART_HEIGHT,H,E);const{values:P,max:w,min:$}=T?s.getBounds(a.CHART_HEIGHT,_,b):{values:null,max:2,min:1};return{offsetY:O,offsetY2:$,scaleY:t.getScaleY(a.CHART_HEIGHT,x,O),scaleY2:t.getScaleY(a.CHART_HEIGHT,w,$),valuesY2:P,valuesY:S,charts:m,valuesX:f}})},,function(e,t,n){"use strict";function a(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};let a,s=Object.create(null),r=[];for(let n in e)n in t?r.length&&(s[n]=r,r=[]):r.push(n);let o={};for(let e in t){if(s[e])for(a=0;a<s[e].length;a++){let t=s[e][a];o[s[e][a]]=n(t)}o[e]=n(e)}for(a=0;a<r.length;a++)o[r[a]]=n(r[a]);return o}function s(e,t){let n=Object.create(null);return e&&e.forEach(e=>{n[e.props.key]=(e=>t?t(e):e)(e)}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.mergeChildMappings=a,t.getChildMapping=s,t.getInitialChildMapping=function(e){return s(e,e=>Object.assign({},e,{props:Object.assign({},e.props,{in:!0,status:"enter"})}))},t.getNextChildMapping=function(e,t,n){let r=s(e),o=a(t,r);return Object.keys(o).forEach(e=>{o[e];const a=e in t,s=e in r,l=t[e],i=l&&!l.props.in;!s||a&&!i?s||!a||i?s&&a&&(n&&(o[e].props.passedProps=n),o[e].props.in=l.props.in):(n&&(o[e].props.passedProps=n),o[e].props.in=!1):(n&&(o[e].props.passedProps=n),o[e].props.in=!0,o[e].props.status="appear")}),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(7),s=n(1),r=n(0),o=n(6),l=n(11);t.patchData=((e,t,n,a)=>{const r=e.columns[0].findIndex(e=>e===n);return e.columns.forEach(e=>e.splice(r,a?t:0,...s.repeat(t,e[r]))),e}),t.cleanData=((e,t,n)=>{const a=e.columns[0].findIndex(e=>e===n);return e.columns.forEach(e=>e.splice(a,t)),e}),t.patchData2=((e,t,n)=>{const a=e.columns[0].findIndex(e=>e===n),s=e.columns.map((e,n)=>e.map((e,s,r)=>0==s?e:s<=a||s>=a+t.columns[0].length-1?0==n?s<=a?t.columns[n][1]:t.columns[n][t.columns[0].length-1]:t.columns[n][1]:t.columns[n][s+1-a]));return Object.assign({},e,{columns:s})});const i=()=>Object.assign({},r.componentMixin(),{state:{data:null,zoomed:!1,zoomedData:null,zoomedOn:null,needToAnimate:null},reducer({type:e,payload:{data:n,timestamp:a}},s){switch(e){case"zoom":return{data:t.patchData(this.props.data[this.props.index],n.columns[0].length,a),zoomedData:n,zoomed:!0,zoomedOn:a,needToAnimate:!0};case"zoom2":return Object.assign({},s,{needToAnimate:!1,data:t.patchData2(this.props.data[this.props.index],s.zoomedData,s.zoomedOn)});case"unzoom":return Object.assign({},s,{data:t.patchData(this.props.data[this.props.index],s.zoomedData.columns[0].length,s.zoomedOn,!0),zoomed:!1,needToAnimate:!0});case"unzoom2":return Object.assign({},s,{data:t.cleanData(this.props.data[this.props.index],s.zoomedData.columns[0].length,s.zoomedOn),needToAnimate:!1})}},getDeriviedStateFromProps(e,t){if(!t.data)return{data:e.data[e.index]}},didUpdate(){this.state.needToAnimate&&(this.state.zoomed?setTimeout(()=>{this.send({type:"zoom2",payload:{}})},10):setTimeout(()=>{this.send({type:"unzoom2",payload:{}})},500))},render(e,t){return r.createElement(l.App,Object.assign({},o.prepareData(t.data,e.index),{zoomed:t.zoomed,onZoom:this.zoom.bind(this),onUnzoom:this.unzoom.bind(this)}))},unzoom(){this.send({type:"unzoom",payload:{}})},zoom(e){const[t,n,a]=new Date(e).toISOString().split("T")[0].split("-"),s=`data/${this.props.index+1}/${t}-${n}/${a}.json`;fetch(s).then(e=>e.json()).then(t=>{this.send({type:"zoom",payload:{data:t,timestamp:e}})})}});window.start=(()=>{r.render(r.createElement("div",{},[,r.createElement(i,{data:a.data,index:0}),r.createElement(i,{data:a.data,index:1}),r.createElement(i,{data:a.data,index:2}),r.createElement(i,{data:a.data,index:3}),r.createElement(i,{data:a.data,index:4})]),document.getElementById("main"))})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(0);t.Animate=(()=>Object.assign({},a.componentMixin(),{id:Date.now(),state:{value:null,cache:null},getDeriviedStateFromProps:(e,t)=>t.value?{cache:t.value,value:e.value}:{value:e.value,cache:e.value},didUpdate(e){e.value!==this.props.value&&this._innerTree.host.dispatchEvent(new Event("animate"))},render(e,t){return a.createElement("animate",{id:"animate"+this.id,attributeName:"d",attributeType:"XML",begin:`animate${this.id}.animate`,from:t.cache,to:t.value,dur:".5s",fill:"freeze"})}}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(3),s=n(0),r=n(12),o=n(13),l=n(2),i=n(4),c=n(5),d=n(1),u=n(14),p=n(15),h=n(16),m=n(6);n(17);t.defaultAppState={extraScale:4,offset:3,sliderPos:{left:.75,right:1},cachedSliderPos:null,touchEndTimestamp:0,mode:"night",showPopupOn:null,visibles:null},t.App=(()=>Object.assign({},s.componentMixin(),{id:Date.now(),state:t.defaultAppState,reducer({type:e,payload:t},n){let a;switch(e){case"updateSlider":return a=1/(t.right-t.left),Object.assign({},n,{extraScale:a,offset:t.left*a,sliderPos:Object.assign({},t)});case"toggle":return Object.assign({},n,{visibles:Object.assign({},n.visibles,{[t]:!n.visibles[t]})});case"toggleAll":const s={};return Object.keys(n.visibles).forEach(e=>{s[e]=e===t}),Object.assign({},n,{visibles:s});case"touchEnd":return Object.assign({},n,{touchEndTimestamp:t});case"mode":return Object.assign({},n,{mode:t});case"showPopup":return Object.assign({},n,{showPopupOn:t});case"hidePopup":return Object.assign({},n,{showPopupOn:null})}},didMount(){const e=this.id;let t,n=!1;window["togglePressChartHandler"+e]=((e,a)=>{a.preventDefault(),n=!0,t=setTimeout(()=>{n=!1,this.send({type:"toggleAll",payload:e})},500)}),window["toggleUnPressChartHandler"+e]=(e=>{n&&(clearTimeout(t),this.send({type:"toggle",payload:e}))}),window["unzoomHandler"+e]=(()=>{this.props.onUnzoom()}),window["toggleDayHandler"+e]=(()=>{const e="day"===this.state.mode?"night":"day";document.body.setAttribute("class",e),this.send({type:"mode",payload:e})}),window["toggleGraphHandler"+e]=(e=>{const t=e.currentTarget;this.send({type:"showPopup",payload:e.targetTouches[0].clientX-10});const n=e=>{const a=e.target;a===t||t.contains(a)||this.send({type:"hidePopup"}),e.currentTarget.removeEventListener("touchstart",n)};setTimeout(()=>{document.documentElement.addEventListener("touchstart",n)},10)})},getDeriviedStateFromProps(e,t){if(!t.visibles)return Object.assign({},t,{visibles:e.visibles});const n={};if(e.charts.forEach(e=>{n[e.id]=null==t.visibles[e.id]||t.visibles[e.id]}),e.zoomed&&!t.cachedSliderPos){const e={visibles:n,cachedSliderPos:t.sliderPos};return this.reducer({type:"updateSlider",payload:{left:3/7,right:4/7}},e)}if(!e.zoomed&&t.cachedSliderPos){const e={visibles:n,cachedSliderPos:null};return this.reducer({type:"updateSlider",payload:t.cachedSliderPos},e)}return Object.assign({},t,{visibles:n})},render(e,t){const n=this.id,{scaleX:f,data:g,dataLength:v,minY:T,pow:y,onZoom:E,zoomed:H,scaledX_:b,y__:_,minX:S,maxX:x}=e,{visibles:O,sliderPos:{left:P,right:w},extraScale:$,offset:C}=t,I=g.y_scaled,A=g.stacked,{charts:M,scaleY:D,scaleY2:j,offsetY:R,offsetY2:Y,valuesY:z,valuesY2:k,valuesX:X}=m.localPrepare(e,t),L=e=>I&&e?j:D,G=e=>I&&e?Y:R,W=s.createElement("div",{class:"abs fw",style:`height: ${l.CHART_HEIGHT}px; z-index: 10`,ontouchstart:`${"toggleGraphHandler"+n}(event)`,ontouchmove:`${"toggleGraphHandler"+n}(event)`}),N=s.createElement(p.Chart,{charts:M,data:g,dataLength:v,offsetY:R,getScale:L,getOffset:G,offset:C,extraScale:$,id:n,scaleY:D,scaleX:f,showPopupOn:t.showPopupOn,zoomed:H,scaledX_:b,y__:_}),F=s.createElement("div",{class:"fw-wrapper w-ch"},[N]),U=s.createElement(u.Dots,{data:g,charts:M,projectChartX:e=>a.round(b(e)*$-C*l.CHART_WIDTH,l.PRECISION),projectChartY:(e,t)=>a.round(_(e=>(e-G(t))*L(t))(e),l.PRECISION),extraScale:$,offset:C,showPopupOn:t.showPopupOn,dataLength:v,pow:y,onZoom:E,id:n,zoomed:H}),B=s.createElement("div",{class:"sliderWrapper",style:`height: ${l.SLIDER_HEIGHT}px; width: ${l.CHART_WIDTH}px`},[s.createElement(o.Slider,Object.assign({onChange:e=>this.send({type:"updateSlider",payload:e}),onTouchEnd:()=>this.send({type:"touchEnd",payload:Date.now()}),eventId:n},t.sliderPos)),s.createElement(h.SliderChart,{charts:M,dataLength:v,minY:T,scaleX:f,isStacked:A,data:g,scaledX_:b,y__:_,zoomed:H})]),V=(l.CHART_WIDTH,t.extraScale,d.catValues(d.rest(g.columns[0]),P,w,S,x)),Z=(d.last(V)-V[0])/36e5/24<3,J=s.createElement(i.TransitionGroup,{wrapper:e=>s.createElement("div",{class:"rel",style:"height: 30px; margin-top: 5px"},[s.createElement("div",{class:"flex-labels-wrapper w-ch",style:`width: ${l.CHART_WIDTH*t.extraScale}px; transform: translateX(${-l.CHART_WIDTH*t.offset}px)`},e)])},[s.createElement(c.Transition,{children:e=>s.createElement("div",{class:`flex-labels fw fh ${e} transition`},X.map((e,t)=>((e,t,n,a)=>s.createElement("span",{class:"l-text flex-item",key:e},d.prettifyDate(e,a?"h:m":"m d")))(e,X.length,0,H&&Z))),key:X.length})]),q=s.createElement("div",{class:"buttons"},Object.keys(O).map(e=>s.createElement("span",{class:`button ${O[e]?"active":""}`,style:`border-color: ${g.colors[e]}; color: ${g.colors[e]}`,ontouchstart:`${"togglePressChartHandler"+n}("${e}", event)`,ontouchend:`${"toggleUnPressChartHandler"+n}("${e}")`},[s.createElement("span",{class:`button-label ${O[e]?"active":""}`,style:`background: ${g.colors[e]}`}),s.createElement("span",{class:`button-icon ${O[e]?"":"hidden"}`}),s.createElement("span",{class:"rel"},g.names[e])]))),K=s.createElement("div",{class:"switch",ontouchstart:`${"toggleDayHandler"+n}()`},"Switch to Nigth Mode"),Q=s.createElement(r.TransitionRuller,{values:z,scale:D,offset:R,valuesY2:k,charts:M,pow:y}),ee=d.prettifyDate(V[0],"dr m y"),te=d.prettifyDate(d.last(V),"dr m y"),ne=d.prettifyDate(V[Math.floor(V.length/2)],"dt, d m y"),ae=s.createElement("div",{class:"flex"},[H?s.createElement("div",{class:"header zoomout rel z-20",ontouchstart:`${"unzoomHandler"+n}()`},"Zoom Out"):s.createElement("div",{class:"header"},"Followers"),s.createElement("div",{class:"b"},H?`${ne}`:`${ee} - ${te}`)]);return s.createElement("div",{class:"rel"},[ae,W,U,Q,F,J,B,q,K])}}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(0),s=n(2),r=n(4),o=n(5),l=n(1);t.TransitionRuller=(()=>Object.assign({},a.componentMixin(),{state:{values:null,valuesY2:null,scaleDirection:null,transformOrigin:null},shouldUpdate(e){return!!e.valuesY2||!l.shallowEqual(e.values,this.props.values)},getDeriviedStateFromProps(e,t){if(!e.values.length){if(!t.valuesY2)return Object.assign({},t,{valuesY2:e.valuesY2});if(e.valuesY2.length){const n=l.last(e.valuesY2)-e.valuesY2[0],a=l.last(t.valuesY2)-t.valuesY2[0];if(a!==n){const s=e.valuesY2[0]-t.valuesY2[0],r=s/(s+(l.last(e.valuesY2)-l.last(t.valuesY2)));return Object.assign({},t,{valuesY2:e.valuesY2,scaleDirection:a>n?"up":"down",transformOrigin:r})}}return t}if(!t.values)return Object.assign({},t,{values:e.values});const n=l.last(e.values)-e.values[0],a=l.last(t.values)-t.values[0];if(a!==n){const s=e.values[0]-t.values[0],r=s/(s+(l.last(e.values)-l.last(t.values)));return Object.assign({},t,{values:e.values,scaleDirection:a>n?"up":"down",transformOrigin:r})}return t},render:(e,t)=>{const{values:n,valuesY2:i,charts:c,pow:d}=e,u=(e,t)=>{if(null==e||isNaN(e))return"";if(0===e)return e+"";switch(t){case 1:return e+"";case 1e3:return`${e}K`;case 1e6:return`${e}M`}};let p,h,m=[];if(i){const e=c.find(e=>"y0"===e.id),a=c.find(e=>"y1"===e.id);p=e&&e.color,h=a&&a.color;const s=l.last(i)-i[0],r=n.length||t.values.length;if(r){const e=s/(r-1);for(let t=0;t<r;t++)m.push(Math.round(2*(i[0]+t*e))/2)}else m=i}const f=!n.length&&i?`${i[0]}-${l.last(i)}`:`${n[0]}-${l.last(n)}`;return a.createElement(r.TransitionGroup,{wrapper:e=>a.createElement("div",{class:`rel scale-${t.scaleDirection} z-5`},e),passedProps:{t:t.transformOrigin}},[c.length>0&&a.createElement(o.Transition,{timeout:500,key:f,children:(e,r)=>a.createElement("div",{key:f,class:`${e} flex column abs fw fh`,style:`height: ${s.CHART_HEIGHT}px; transform-origin: 0 ${s.CHART_HEIGHT*(1-(r&&null!=r.t?r.t:t.transformOrigin||0))}px`},(n.length?n:m).map((e,t)=>a.createElement("div",{class:"r-line fw"},i?[a.createElement("span",{style:`color: ${p}`,class:`${p?"entered":"exited"} transition`},u(e,d)),a.createElement("span",{style:`color: ${h}`,class:`${h?"entered":"exited"} transition`},u(m[t],d))]:u(e,d))))})])}}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(1),s=n(0),r=n(2);t.Slider=(()=>Object.assign({},s.componentMixin(),{state:{left:3*r.CHART_WIDTH/4,right:r.CHART_WIDTH},didMount(){let e,t,n,s,r;const o=this.props.eventId,l=a=>{const{left:o,right:l}=this.state;e=a,s=a-(t=o),r=-((n=l)-a)};window["onSliderTouch"+o]=a.createRaf(e=>{e.preventDefault(),this.send({type:"updatePos",payload:e.targetTouches[0].clientX-s})}),window["onSliderTouchResizeRight"+o]=a.createRaf(e=>{this.send({type:"updateRight",payload:e.targetTouches[0].clientX-r})}),window["onSliderTouchResizeLeft"+o]=a.createRaf(e=>{this.send({type:"updateLeft",payload:e.targetTouches[0].clientX-s})}),window["onSliderStartTouch"+o]=(e=>{e.preventDefault(),l(e.targetTouches[0].clientX)}),window["onSliderTouchEnd"+o]=(()=>{this.props.onTouchEnd()})},getDeriviedStateFromProps:(e,t)=>Math.abs(e.left-t.left/r.CHART_WIDTH)>.1||Math.abs(e.right-t.right/r.CHART_WIDTH)>.1?{left:e.left*r.CHART_WIDTH,right:e.right*r.CHART_WIDTH,forceAnimate:!0}:t,didUpdate(e,t){const n=this.state.left/r.CHART_WIDTH,a=this.state.right/r.CHART_WIDTH;t.left===this.state.left&&t.right===this.state.right||this.props.onChange({left:n,right:a}),this.state.forceAnimate&&setTimeout(()=>{this.send({type:"cleanAnimation"})},500)},reducer({type:e,payload:t},n){switch(e){case"cleanAnimation":return Object.assign({},n,{forceAnimate:!1});case"updatePos":const a=n.right-n.left;return t<0?{left:0,right:a}:t+a>r.CHART_WIDTH?{left:r.CHART_WIDTH-a,right:r.CHART_WIDTH}:{left:t,right:a+t};case"updateRight":return t>r.CHART_WIDTH?Object.assign({},n,{right:r.CHART_WIDTH}):t<50+n.left?Object.assign({},n,{right:50+n.left}):Object.assign({},n,{right:t});case"updateLeft":return t<0?Object.assign({},n,{left:0}):t>n.right-50?Object.assign({},n,{left:n.right-50}):Object.assign({},n,{left:t})}},render:(e,t)=>{const n=e.eventId;return s.createElement("div",{class:"fh abs fw"},[s.createElement("div",{ontouchstart:`${"onSliderStartTouch"+n}(event)`,ontouchend:`${"onSliderTouchEnd"+n}()`,ontouchcancel:`${"onSliderTouchEnd"+n}()`,ontouchmove:`${"onSliderTouch"+n}(event)`,class:"sliderCenter fh abs fw"}),s.createElement("div",{style:`transform: translateX(${t.right}px)`,class:`sliderEdgeBg right ${t.forceAnimate?"transition-d":""}`},[s.createElement("div",{class:"sliderEdge right",ontouchstart:`${"onSliderStartTouch"+n}(event)`,ontouchend:`${"onSliderTouchEnd"+n}()`,ontouchcancel:`${"onSliderTouchEnd"+n}()`,ontouchmove:`${"onSliderTouchResizeRight"+n}(event)`})]),s.createElement("div",{style:`transform: translateX(${t.left}px)`,class:`sliderEdgeBg left ${t.forceAnimate?"transition-d":""}`},[s.createElement("div",{class:"sliderEdge left",ontouchstart:`${"onSliderStartTouch"+n}(event)`,ontouchend:`${"onSliderTouchEnd"+n}()`,ontouchcancel:`${"onSliderTouchEnd"+n}()`,ontouchmove:`${"onSliderTouchResizeLeft"+n}(event)`})])])}}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(0),s=n(1),r=n(2),o=n(3);t.Dots=(()=>Object.assign({},a.componentMixin(),{state:{charts:null},getDeriviedStateFromProps(e,t){const{charts:n,data:a,showPopupOn:s}=e;if(a.stacked&&a.percentage&&t.charts&&n.length!==t.charts.length&&s){console.log("run calculus");let t=Array(e.dataLength).fill(0);const a=e.charts.length,s=[];for(let t=0;t<e.dataLength;t++){let n=0;for(let s=0;s<a;s++)n+=e.charts[s].values[t];s.push(n)}return{charts:n.map(e=>{const n=e.values.map((e,t)=>o.round(e/s[t]*100,0));return t=t.map((e,t)=>e+n[t]),Object.assign({},e,{values:n})})}}return{charts:n}},didMount(){window["popupClickHandler"+this.props.id]=(e=>{this.props.onZoom(e)})},render(e,t){const{projectChartX:n,projectChartY:o,data:l,dataLength:i,extraScale:c,id:d,zoomed:u}=e,{charts:p}=t,h=e.showPopupOn;if(!h)return a.createElement("span",{});const m=l.columns[0],f=m.findIndex((e,t,a)=>t>1&&Number(n((e+a[t-1])/2))<=h&&Number(n((a[t+1]+e)/2))>h);if(-1===f)return a.createElement("span",{});const g=p.map(e=>e.values[f]),v=m[f+1],T=p.map(e=>e.id),y=(e,t)=>e.reduce((e,n,a)=>a>=t?e:e+n,0),E=n(v),H=E<r.CHART_WIDTH/2?E+15:E-160-15,b=a.createElement("div",{class:"popup abs z-20",style:`width: 160px; top: 10px; left:${H}px`,ontouchstart:u?"":`${"popupClickHandler"+d}(${v})`},[a.createElement("div",{class:"flex p"},[a.createElement("span",{class:"b"},s.prettifyDate(v,"dt, d m y")),!u&&a.createElement("span",{class:"popup-arrow"})]),...p.map(({values:e,color:t,name:n,originalValues:s})=>a.createElement("div",{class:"flex p"},[a.createElement("span",{},l.percentage?[a.createElement("span",{class:"b proc"},`${Math.round(e[f])}%`),a.createElement("span",{},`${n}`)]:n),a.createElement("span",{class:"b",style:`color: ${t}`},s[f]+"")])),l.stacked&&!l.percentage&&1!==p.length&&a.createElement("div",{class:"flex p"},[a.createElement("span",{},"All"),a.createElement("span",{class:"b"},y(p.map(e=>e.originalValues[f]),g.length)+"")])]),_=a.createElement("svg",{overflow:"visible",width:r.CHART_WIDTH,height:r.CHART_HEIGHT,key:f},g.map((e,t,n)=>s.path(s.createStackedPathAttr([[v,e]],e=>E,o,[y(n,t)]),l.colors[T[t]],r.CHART_WIDTH*c/(u?168:i)+.05,"",!0))),S=a.createElement("svg",{overflow:"visible",class:"popup-rect"},[a.createElement("svg",{x:E,y:0,width:r.CHART_WIDTH,height:r.CHART_HEIGHT,overflow:"visible"},[a.createElement("line",{x1:0,y1:0,x2:0,y2:r.CHART_HEIGHT,"stroke-width":"1",stroke:"rgba(115,153,178, .2)",key:"line"}),...l.percentage?[]:T.map((e,t)=>a.createElement("circle",{cx:0,cy:o(g[t],"y1"===e),r:4,stroke:l.colors[e],class:"n-fill",key:`circle${e}`,"stroke-width":2}))])]);return a.createElement("div",{class:"abs fw top",style:`height: ${r.CHART_HEIGHT}`},l.stacked&&!l.percentage?[_,b]:[S,b])}}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(0),s=n(2),r=n(4),o=n(5),l=n(1),i=n(3);t.Chart=(()=>Object.assign({},a.componentMixin(),{state:{chartPathes:null,zoomed:null,relScaleX:null,relScaleY:null,rescaled:!1},getDeriviedStateFromProps(e,t){const n=Object.assign({},t);if(n.relScaleX||(n.relScaleX=e.extraScale,n.relScaleY=e.scaleY),!e.data.stacked)return n;if(!n.chartPathes||e.charts.length!==n.chartPathes.length||e.zoomed!=n.zoomed){if(e.data.percentage){let t=Array(e.dataLength).fill(0);const a=[],s=e.charts.length,r=[];for(let t=0;t<e.dataLength;t++){let n=0;for(let a=0;a<s;a++)n+=e.charts[a].values[t];r.push(n)}for(let n of e.charts){const s=n.dots.map(([e,t],n)=>[e,i.round(t/r[n]*100,1)]),o=l.createPercentagePathAttr(s,e.scaledX_,e.y__(e=>e),t);a.push(o),t=t.map((e,t)=>e+s[t][1])}return Object.assign({},n,{chartPathes:a})}{let t=Array(e.dataLength).fill(0),a=Object.assign({},n,{chartPathes:[]});const s=e.data.percentage?l.createPercentagePathAttr:l.createStackedPathAttr;for(let n of e.charts){const r=s(n.dots,e.scaledX_,e.y__(e=>e),t);a.chartPathes.push(r),t=t.map((e,t)=>e+n.values[t])}return a}}return n},timer:null,reducer(e,t){switch(e.type){case"scale2":return Object.assign({},t,{rescaled:!1});case"scale":return Object.assign({},t,{rescaled:!0,relScaleX:e.payload.scaleX,relScaleY:e.payload.scaleY})}},didUpdate(){const e=this.props,t=this.state;e.data.y_scaled||e.data.stacked||(t.rescaled?setTimeout(()=>{this.send({type:"scale2"})},100):(this.timer&&clearTimeout(this.timer),t.relScaleX===e.extraScale&&t.relScaleY===e.scaleY||(this.timer=setTimeout(()=>{clearTimeout(this.timer),this.send({type:"scale",payload:{scaleX:e.extraScale,scaleY:e.scaleY}})},500))))},render(e,t){const{charts:n,data:c,extraScale:d,offset:u,getOffset:p,getScale:h,id:m,scaleY:f,offsetY:g,showPopupOn:v,zoomed:T}=e,{dataLength:y}=e,{relScaleX:E,relScaleY:H}=t,{y_scaled:b,stacked:_,percentage:S}=c,x=v&&_&&!S?.5:1,O=u*s.CHART_WIDTH,P=i.round(d/E,s.PRECISION),w=i.round(f/H,s.PRECISION);return(e=>b?e:a.createElement("div",{style:`\n          height: ${s.CHART_HEIGHT}px;\n          transform: scaleX(${P}) translateX(-${O/P}px);\n          transform-origin: 0 ${s.CHART_HEIGHT}px;\n          opacity: ${x}`},[a.createElement("div",{style:`transform: scaleY(${w}) translateY(${g*H}px);transform-origin: 0 ${s.CHART_HEIGHT}px;`,class:t.rescaled?"":"transition-d"},[e])]))(a.createElement(r.TransitionGroup,{wrapper:e=>a.createElement("svg",{width:s.CHART_WIDTH,height:s.CHART_HEIGHT,overflow:"visible",viewBox:`${b?O/d:0} 0 ${b?s.CHART_WIDTH/d:s.CHART_WIDTH} ${s.CHART_HEIGHT}`,preserveAspectRatio:"none"},b?e:[a.createElement("g",{style:`transform: scale(${E} ,${H}); transform-origin: 0 ${s.CHART_HEIGHT}px;`},e)])},n.slice(0).reverse().map(({color:e,chartPath:r,id:i},c)=>a.createElement(o.Transition,{key:e,timeout:500,children:o=>b?a.createElement("g",{style:`\n                          transform: scaleY(${h("y1"===i)}) translateY(${p("y1"===i)}px);\n                          transform-origin: 0 ${s.CHART_HEIGHT}px;\n                          opacity: ${x}`,class:"transition-d"},[l.path(r,e,2,o)]):l.path(_?t.chartPathes[n.length-1-c]:r,e,_?T?s.CHART_WIDTH/168+.05:s.CHART_WIDTH/y+.05:2,o,_,S)}))))}}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(0),s=n(4),r=n(2),o=n(5),l=n(1),i=n(6),c=n(3);t.SliderChart=(()=>Object.assign({},a.componentMixin(),{state:{chartPathes:null,zoomed:null},getDeriviedStateFromProps(e,t){if(!e.isStacked)return t;if(!t.chartPathes||e.charts.length!==t.chartPathes.length||e.zoomed!=t.zoomed){const{dataLength:n,charts:a,minY:s,scaleX:o,scaledX_:d,y__:u}=e;if(e.data.percentage){const n=100;let a=i.getScaleY(r.SLIDER_HEIGHT,n,s);const o=e=>c.round(r.SLIDER_HEIGHT-(e-s)*a,1);let u=Array(e.dataLength).fill(0);const p=e.charts.length,h=[];let m=Object.assign({},t,{chartPathes:[]});for(let t=0;t<e.dataLength;t++){let n=0;for(let a=0;a<p;a++)n+=e.charts[a].values[t];h.push(n)}for(let t of e.charts){const e=t.dots.map(([e,t],n)=>[e,c.round(t/h[n]*100,1)]),n=l.createPercentagePathAttr(e,d,o,u);m.chartPathes.push(n),u=u.map((t,n)=>t+e[n][1])}return m}{const e=l.getStackedMax(0,n,a);let o=i.getScaleY(r.SLIDER_HEIGHT,e,s);const u=e=>c.round(r.SLIDER_HEIGHT-(e-s)*o,1);let p=Array(n).fill(0),h=Object.assign({},t,{chartPathes:[]});for(let e of a){const t=l.createStackedPathAttr(e.dots,d,u,p);h.chartPathes.push(t),p=p.map((t,n)=>t+e.values[n])}return h}}return t},render(e,t){const{charts:n,isStacked:i,dataLength:c,data:d,zoomed:u}=e;return a.createElement(s.TransitionGroup,{wrapper:e=>a.createElement("svg",{width:r.CHART_WIDTH,height:r.SLIDER_HEIGHT},e)},n.slice(0).reverse().map(({color:e,sliderPath:s},p)=>a.createElement(o.Transition,{key:e,children:a=>l.path(i?t.chartPathes[n.length-1-p]:s,e,i?r.CHART_WIDTH/(u?168:c):1,a,i,d.percentage)})))}}))},function(e,t,n){}]);